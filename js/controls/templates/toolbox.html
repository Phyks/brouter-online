<div class="toolbox" ref="el">
  <section class="waypoints">
    <div class="inner">
      {#list waypoints.items() as waypoint}
      <div class="waypoint">
        <label>{this.waypointLetter(waypoint_index)}</label>
        <input type="text" r-model={waypoint.text} typeahead={this.typeahead(waypoint)}>
      </div>
      {/list}
    </div>

    <button class="search-button" on-click={this.calculateRoute(true)}>
      {#if loading}
      <!-- By Sam Herbert (@sherb), for everyone. More @ http://goo.gl/7AJzbL -->
      <svg width="26" height="26" viewBox="0 0 38 38">
          <defs>
              <linearGradient x1="8.042%" y1="0%" x2="65.682%" y2="23.865%" id="a">
                  <stop stop-color="#fff" stop-opacity="0" offset="0%"/>
                  <stop stop-color="#fff" stop-opacity=".631" offset="63.146%"/>
                  <stop stop-color="#fff" offset="100%"/>
              </linearGradient>
          </defs>
          <g fill="none" fill-rule="evenodd">
              <g transform="translate(1 1)">
                  <path d="M36 18c0-9.94-8.06-18-18-18" id="Oval-2" stroke="url(#a)" stroke-width="2">
                      <animateTransform
                          attributeName="transform"
                          type="rotate"
                          from="0 18 18"
                          to="360 18 18"
                          dur="0.9s"
                          repeatCount="indefinite" />
                  </path>
                  <circle fill="#fff" cx="36" cy="18" r="1">
                      <animateTransform
                          attributeName="transform"
                          type="rotate"
                          from="0 18 18"
                          to="360 18 18"
                          dur="0.9s"
                          repeatCount="indefinite" />
                  </circle>
              </g>
          </g>
      </svg>
      {#else}
      <svg width="23" height="31" viewBox="0 0 23 31" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="#fff"><g><g><path d="M.5 8.36c0 .07.024.14.073.2.098.117.27.16.422.106L5.512 7.05v23.623c0 .18.162.327.362.327h3.62c.2 0 .36-.147.36-.327v-8.288l.01.003c.114-.272 1.19-2.573 4.797-2.76l-1.73 3.973c-.06.138-.013.294.117.382.13.09.31.09.44 0l8.872-6.178c.088-.062.14-.158.14-.26 0-.1-.052-.197-.14-.26l-8.874-6.176c-.065-.045-.143-.067-.22-.067-.077 0-.154.022-.218.067-.13.088-.18.245-.12.382l1.785 4.088v.335c-2.03.06-3.622.54-4.857 1.195V7.05l4.517 1.616c.152.054.324.01.422-.108.097-.117.097-.28-.002-.397L7.97.13C7.904.048 7.798 0 7.685 0c-.112 0-.218.047-.286.128L.576 8.16c-.05.06-.076.13-.076.2z"/></g></g></g></g></svg>
      {/if}
    </button>

    <div class="swap" on-click={this.swap()}>
      <svg width="8" height="23" viewBox="0 0 8 23" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="#D1D1D0"><g><path d="M5 9h3L4 0 0 9h3v5H0l4 9 4-9H5V9z"/></g></g></g></svg>
    </div>
  </section>

  <TypeAheadMenu ref="typeahead"/>

  <section class="profile">
    <div class="flex v-center">
      <svg class="profile-icon" width="36" height="22" viewBox="0 0 36 22" xmlns="http://www.w3.org/2000/svg"><title>Bicycle</title><desc>Created with Sketch.</desc><g fill="none" fill-rule="evenodd"><g fill="#191716"><g><g><path d="M36 14.734C36 18.742 32.555 22 28.323 22c-4.235 0-7.676-3.258-7.676-7.266 0-3.147 2.13-5.827 5.095-6.833l-.6-2.264-7.813 9.275s-.35.528-1.014.528h-1.002C14.94 19.116 11.66 22 7.674 22 3.443 22 0 18.742 0 14.734 0 10.727 3.442 7.47 7.675 7.47c1.343 0 2.605.33 3.704.906l2.05-2.836L12.264.938h4.265s1.308 1.066 0 1.407h-2.38l.535 2.11h10.14l-.81-3.048s-1.302-.066-2.626 0C20.473.65 21.39 0 21.39 0h6.935s.984.65 0 1.407h-2.778l1.635 6.152c.374-.053.753-.09 1.143-.09C32.555 7.466 36 10.726 36 14.733zM12.604 9.17c1.497 1.193 2.512 2.915 2.71 4.86h.272l-1.688-6.65-1.294 1.79zm-.848 1.17l-2.673 3.69h4.734c-.185-1.464-.947-2.762-2.06-3.69zm2.06 5.098H7.583c-1.3 0-.923-.544-.923-.544l3.873-5.353c-.857-.423-1.83-.666-2.86-.666-3.413 0-6.19 2.63-6.19 5.86 0 3.23 2.777 5.86 6.19 5.86 3.165 0 5.774-2.256 6.144-5.156zm9.235-9.58h-8.01l1.854 7.312 6.157-7.313zm11.464 8.876c0-3.23-2.777-5.858-6.19-5.858-.264 0-.523.02-.778.052l1.498 5.636s-.5 1.454-1.44.344c-.3-1.12-1.497-5.636-1.497-5.636-2.32.846-3.972 2.974-3.972 5.464 0 3.23 2.776 5.86 6.19 5.86 3.412-.003 6.19-2.632 6.19-5.862z"/></g></g></g></g></svg>

      <div class="field" style="width: 120px">
        <label>Profile:</label>
        <div class="dropdown">
          <button r-class="{{active: showProfileDropdown}}" on-click={this.toggleProfileDropdown()}>{profile.name} <i class="caret"/></button>
          {#if showProfileDropdown}
          <div class="dropdown-menu">
            {#list profiles as profile}
            <span class="item" on-click={this.setProfile(profile)}>{profile.name}</span>
            {/list}
          </div>
          {/if}
        </div>
      </div>
      <div class="field">
        <label>Route index:</label>
        <span class="badge" r-class="{{active: alternativeidx === 0}}" on-click={this.setAlternativeIndex(0)}>1</span>
        <span class="badge" r-class="{{active: alternativeidx === 1}}" on-click={this.setAlternativeIndex(1)}>2</span>
        <span class="badge" r-class="{{active: alternativeidx === 2}}" on-click={this.setAlternativeIndex(2)}>3</span>
        <span class="badge" r-class="{{active: alternativeidx === 3}}" on-click={this.setAlternativeIndex(3)}>4</span>
      </div>

      <div class="auto"></div>

      {#if profile.options}
      <button r-class="{{active: showProfileOptions}}" on-click={this.toggleProfileOptions()}>
        <svg class="settings-icon" width="16" height="18" viewBox="0 0 16 18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="#191716" opacity=".203"><g><g><path d="M2.91 4.125H1.454V0H2.91v4.125zM4.363 8.25c0 .203-.072.38-.216.527-.144.15-.315.223-.512.223H.726C.53 9 .36 8.926.217 8.777.072 8.63 0 8.453 0 8.25v-3c0-.203.072-.38.216-.527.144-.15.314-.223.51-.223h2.91c.197 0 .368.074.512.223.144.148.216.324.216.527v3zm4.363 1.875H7.273V0h1.454v10.125zm5.818-7.5H13.09V0h1.455v2.625zM2.91 18H1.454V9.375H2.91V18zM16 6.75c0 .203-.072.38-.216.527-.144.15-.314.223-.51.223h-2.91c-.197 0-.368-.074-.512-.223-.144-.148-.216-.324-.216-.527v-3c0-.203.072-.38.216-.527.144-.15.315-.223.512-.223h2.91c.196 0 .366.074.51.223.144.148.216.324.216.527v3zm-5.818 7.5c0 .203-.072.38-.216.527-.144.15-.314.223-.51.223h-2.91c-.198 0-.368-.074-.512-.223-.144-.148-.216-.324-.216-.527v-3c0-.203.072-.38.216-.527.144-.15.314-.223.51-.223h2.91c.198 0 .368.074.512.223.144.148.216.324.216.527v3zM8.727 18H7.273v-2.625h1.454V18zm5.818 0H13.09V7.875h1.455V18z"/></g></g></g></g></svg>
      </button>
      {/if}
    </div>

    {#if profile.options && showProfileOptions}
    <div class="profile-options">
      {#if profile.options.indexOf('consider_elevation') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('consider_elevation', $event)}" checked={profileOptions.consider_elevation}/> Consider elevation</label>{/if}
      {#if profile.options.indexOf('allow_steps') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('allow_steps', $event)}" checked={profileOptions.allow_steps}/> Allow steps</label>{/if}
      {#if profile.options.indexOf('allow_ferries') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('allow_ferries', $event)}" checked={profileOptions.allow_ferries}/> Allow ferries</label>{/if}
      {#if profile.options.indexOf('ignore_cycleroutes') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('ignore_cycleroutes', $event)}" checked={profileOptions.ignore_cycleroutes}/> Ignore cycleroutes</label>{/if}
      {#if profile.options.indexOf('stick_to_cycleroutes') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('stick_to_cycleroutes', $event)}" checked={profileOptions.stick_to_cycleroutes}/> Stick to cycleroutes</label>{/if}
      {#if profile.options.indexOf('avoid_unsafe') > -1}<label><input type="checkbox" on-change="{this.toggleProfileOption('avoid_unsafe', $event)}" checked={profileOptions.avoid_unsafe}/> Avoid unsafe</label>{/if}
    </div>
    {/if}
  </section>

  {#if info}<section class="info">{#include info}</section>{/if}

  {#list routes.items() as route}
  <section class="card">
    <div class="flex s-b">
      <div>
        <strong>{route.from.text}</strong> - <strong>{route.to.text}</strong>
      </div>
      <div>
        <small class="text-muted nowrap">{route.trackLength|km}</small>
      </div>
    </div>
  </section>
  {/list}
</div>
